package maxpower;

import java.util.ArrayList;
import java.util.List;
import java.util.Random;

import org.junit.Assert;
import org.junit.Test;

public class TreeReduceTest {
	static class Adder implements TreeReduce.Reducer<Integer> {
		@Override
		public Integer reduce(List<Integer> values) {
			int sum = 0;
			for (int v : values) sum += v;
			return sum;
		}
	}

	@Test
	public void testTreeReduce() {
		long seed = System.currentTimeMillis();
		System.out.println("Using seed: " + seed);

		final int N = 123;
		final int ITER = 1000;

		Random rng = new Random(seed);

		for (int iter = 0; iter < ITER; ++iter) {
			List<Integer> values = new ArrayList<Integer>(N);

			int expected = 0;
			for (int i = 0; i < N; ++i) {
				int v = rng.nextInt();
				values.add(v);
				expected += v;
			}

			Adder adder = new Adder();
			for (int n = 2; n < 5; ++n) {
				Assert.assertEquals("tree reduce, n = "+n, expected, (int) TreeReduce.reduce(n, adder, values));
			}
		}
	}
}
